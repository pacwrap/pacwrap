#!/bin/bash
#
#  PacWrap -- Front-end Script
# 
#  Copyright (C) 2023 Xavier R.M. 
#  sapphirus(at)azorium(dot)net
#
#
#    This program is free software: you can redistribute it and/or modify
#    it under the terms of the GNU General Public License as published by
#    the Free Software Foundation, with only version 3 of the License.
#
#    This program is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU General Public License for more details.
#
#    You should have received a copy of the GNU General Public License
#    along with this program.  If not, see <https://www.gnu.org/licenses/>.

source pacwrap-common

main () {
	parse_args "$@"
	test_runtime

	[[ $SWITCH != V ]] && [[ $SWITCH != h ]] && distro_warn

	case $SWITCH in 
		P)	source $(type -P $PS_SCRIPT);;	
		C)	source $(type -P $CREATE_SCRIPT);;
		E*)	source $(type -P $EXEC_SCRIPT);;
		S)	source $(type -P $SYNC_SCRIPT);;
		U)	source $(type -P $UTILS_SCRIPT);;
		h|V)	manual_script;;
		*)	log_invalid_arguments $1
		esac
}

parse_args () {
	for var in "$@"; do case $var in
		-v|--verbose)		SWITCH+=v;;
		--process|-P)		SWITCH=P;;
		--create|-C)		SWITCH=C;;
		--execute|-E)		SWITCH=E;;
		--pacman|--explicit)	SWITCH=Ep;;
		--sync|-S)		SWITCH=S;;
		--utils|-U)		SWITCH=U;;
		--help=*)		HELP="${var:7}"
					SWITCH=h;;
		-h|--help)		SWITCH=h;;
		-V|--version)		SWITCH=V;;
		-E*|-C*|-S*|-U*|-P*)	SWITCH=${var:1:1};;
		*) 			ARGS+=("$var")
	esac; [[ $SWITCH ]] && break; done
}

main $@
