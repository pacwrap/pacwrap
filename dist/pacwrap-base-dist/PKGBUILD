# Maintainer: Xavier R.M. (sapphirus at azorium dot net)

pkgname=('pacwrap-base-dist')
pkgver=0.3.2
pkgrel=1
pkgdesc=""
arch=('any')
url="https://pacwrap.sapphirus.org/"
license=('GPLv3-only')
conflicts=('pacwrap-base-dist')
depends=('fakeroot' 'fakechroot')

source=("${pkgname}-${pkgver}-${pkgrel}.tar.zst::${pkgname}-${pkgver}-${pkgrel}.tar.zst")
sha512sums=('6eac63277879ad77b0eb18a8b284630dd8f212a37b36634924cb2d6e602c5281874ab7f0302773d11b3b97ae159df3fa10ced2f187d18b848c0f6e122981605c')

package() {
  	cd "${srcdir}"

	local pacman_hooks=('20-systemd-sysusers'
			    '30-systemd-tmpfiles' 
			    '30-systemd-daemon-reload'
			    '30-systemd-sysctl'
			    '30-systemd-catalog'
			    '30-systemd-update'
		    	    '30-systemd-udev-reload'
			    '30-systemd-hwdb'
		    	    'dbus-reload')
	
	mkdir -p "$pkgdir/etc/pacman.d/hooks/"
	for pacman_hook in ${pacman_hooks[@]}; do
		ln -s /dev/null "$pkgdir/etc/pacman.d/hooks/$pacman_hook.hook"; done
   	install -Dm 644 "dist_src/0-pacwrap-dist.hook" "${pkgdir}/usr/share/libalpm/hooks/0-pacwrap-dist.hook"
   	install -Dm 644 "dist_src/42-trust-permission.hook" "${pkgdir}/usr/share/libalpm/hooks/42-trust-permission.hook"
   	install -Dm 755 "dist_src/pacwrap-dist" "${pkgdir}/usr/bin/pacwrap-dist"
}
